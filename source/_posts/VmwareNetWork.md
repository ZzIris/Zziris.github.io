---
title: 虚拟机中的网络设置
date: 2019-08-01 21:46:53
tags:
- 网络
- 虚拟机
categories:
- 虚拟机使用
---

# 一. 前言

&emsp;&emsp;经历了一周的公司外出培（养）训（猪）终于又回来了，这段时间也是学到了很多关于公司云计算业务的相关东西也结识一批优秀的小伙伴，大家一起也是玩得很开心。今天培训结束以后也是该时候收收心继续投入工作与学习中了。想起在去培训之前在使用虚拟机时碰到的一些关于网络配置的问题还未做归纳总结，故以此篇文章来进行相关知识点的梳理。

# 二. 关于虚拟机的网络配置问题

&emsp;&emsp;在公司所使用的虚拟机软件为VirtualBox（简称VB）。在VB中我们可以看到每台虚拟机在硬件设置中有一个网络选项，该网络选项中的连接方式有
```
1. 网络地址转换（NAT）
2. NAT网络
3. 桥接网卡
4. 内部网路
5. 仅主机（Host-Only）网络
6. 通用驱动
```
&emsp;&emsp;原来起初在开始使用VB时，连接着公司的无线网，因此我是用了桥接网卡的网络设置，在该模式下，虚拟机相当于一台子网中的真实机，其占用真实网段的一个ip地址，因此其可以与我的宿主机互相通信，彼此都可见。
&emsp;&emsp;而后来在申请了公司的固定工作ip后，我使用插网线的方式进行工作，此时我的主机所处的网段发生了改变，不再处于无线网的网段中，而由于之前在虚拟机上设置了静态ip上网，所设置的ip网段为无线网网段，由于再次进行ip的修改会比较繁琐，且我虚拟机中所搭建的ceph集群ip地址都已设置好，再且连接网线后所处的网段为工作网段，固定工作ip需要进行申请，我不可能为每一台虚拟机都去申请一个ip来使用。因此此时虚拟机再使用桥接模式来设置网络已经明显不合适，此时需要改变网络配置模式。此处将选用NAT网络模式。
&emsp;&emsp;在NAT模式下，虚拟机将处于自己的一个虚拟子网，其上网相当于将虚拟子网进行NAT后再对外进行网络数据传输，就如同我们在上网时，内部的局域网要想获取互联网中的信息，需要将我们的ip地址映射成对外上网的公网ip来获取互联网中的数据，从公网角度看我们的内部局域网内部完全是透明的，外部只知道有这么一个公网ip。而NAT网络模式很类似，其对于宿主机所处的真实网段而言，其是透明的，即处于真实网段的主机都无法知道其的存在，而虚拟机可以在其所处的虚拟网段中通过NAT来给我们处于真实网段的主机发送数据。因此通过这一特性，我们就可以另外设置我们的虚拟网段为与我们原来所处无线网段相同的ip网段，并且也不受宿主机所处网段变化的影响。

## 1. 